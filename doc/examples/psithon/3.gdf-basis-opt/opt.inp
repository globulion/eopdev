#!/usr/bin/python3
"""
 Fit auxiliary basis set for water molecule, that is well suited for
 OEP of type GDF:S1 from Murrell et al. theory of Pauli repulsion energy.

 Example: minimal basis sets (decontracted and contracted)
"""
import gefp

molecule h2o {
0 1
O    0.00000    0.00000    0.00000 
H    0.55268   -0.64111   -0.41769 
H    0.15452    0.82612   -0.42960 

units angstrom
symmetry c1
noreorient
nocom
}

set {
    basis                         6-31++G**
    scf_type                      pk
    maxiter                       300
    guess                         core
    print                         1
    puream                        False
    e_convergence                 1e7
}

# fit auxiliary basis sets. Primary basis set is taken from global options.
# save output basis in Psi4 formats
basis1= gefp.core.gdf_basisset_optimizer(h2o, 'pauli', 
                                         out        = 'oepfit-mini.gbs',
                                         templ_file = 'input/templ.mini.dat',
                                         param_file = 'input/param.mini.dat',
                                         bounds_file= 'input/bounds.mini.dat',
                                         basis_int  = "aug-cc-pvdz-jkfit", 
                                         basis_xpl  = "6-311++g**")

basis2= gefp.core.gdf_basisset_optimizer(h2o, 'pauli', 
                                         out        = 'oepfit-mini-decontr.gbs',
                                         templ_file = 'input/templ.mini-decontr.dat',
                                         param_file = 'input/param.mini-decontr.dat',
                                         bounds_file= None,
                                         basis_int  = "aug-cc-pvdz-jkfit", 
                                         basis_xpl  = "6-311++g**")
