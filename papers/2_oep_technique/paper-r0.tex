\input{header.tex}
\begin{document}
\preprint{AIP/123-OEP}

\title{Ab Initio Effective One-Electron Potentials 
for Repulsive and Charge-Transfer Interaction Energies at Hartree-Fock Level}

\author{Bartosz B{\l}asiak}
\email[]{blasiak.bartosz@gmail.com}
\homepage[]{https://www.polonez.pwr.edu.pl}

\author{Marta Cho{\l}uj} 
\author{Joanna Bednarska}
\author{Wojciech Bartkowiak}

\affiliation{Department of Physical and Quantum Chemistry, Faculty of Chemistry, 
Wroc{\l}aw University of Science and Technology, 
Wybrze{\.z}e Wyspia{\'n}skiego 27, Wroc{\l}aw 50-370, Poland}

\date{\today}

\begin{abstract}
The concept of the effective one-electron potentials has been useful for many decades
in efficient description of electronic structure of chemical systems, especially extended
molecular aggregates such as interacting molecules in condensed phases. 
In this Work, \emph{ab initio} effective potentials are studied for a number of theories
of the intemolecular interaction energy.
\end{abstract}

\pacs{}

\maketitle

\tableofcontents

\section{\label{s:1}Introduction}

\section{\label{s:2}Effective One-Electron Potentials: General Form}

The one\hyp{}electron potential $v^{\rm eff}({\bf r})$
produced by a certain effective one\hyp{}electron charge density distribution $\rho^{\rm eff}({\bf r})$
is 
%
\begin{equation}
	v^{\rm eff}({\bf r}) = \int \frac{ \rho^{\rm eff}({\bf r}') }{ \vert {\bf r}' - {\bf r} \vert} d{\bf r}' \;,
\end{equation}
%
where ${\bf r}$ is a spatial coordinate. Formally, the effective density can be expanded in terms of an effective
one\hyp{}particle density matrix represented in a certain basis of orbitals, $\BM{\phi}({\bf r})$,
%
\begin{equation}
	\rho^{\rm eff}({\bf r}) = \sum_{\alpha\beta} D_{\alpha\beta}^{\rm eff} 
	\phi_\alpha({\bf r}) \phi_\beta^{*}({\bf r})  \;.
\end{equation}
%
Based on that, the operator form of the effective potential 
can be written as
%
\begin{equation}
	\hat{v}^{\rm eff} = \sum_{\alpha\beta} 
	\ket{\alpha} 
	\left[
	\int
	\hat{J}^{\rm}_{\alpha\beta}({\bf r}) 
	\rho^{\rm eff}({\bf r})
	d{\bf r} 
	\right]
	\bra{\beta}  
\end{equation}
%
with the Coulomb operator defined by
%
\begin{equation}
	\hat{J}^{\rm}_{\alpha\beta}({\bf r}) f({\bf r}) \equiv
	f({\bf r}) 
	\int
	\frac{ \phi_\alpha^{*}({\bf r}') \phi_\beta({\bf r}') }{ \vert {\bf r}' - {\bf r} \vert} d{\bf r}'
\end{equation}
%
for any one\hyp{}electron function $f({\bf r})$. The matrix element of the effective potential operator
is therefore given by
%
\begin{equation}
	\tbraket{\alpha}{ \hat{v}^{\rm eff} }{\beta}
	= \sum_{\gamma\delta} \braket{\alpha\beta}{\gamma\delta} D^{\rm eff}_{\gamma\delta}  \;.
\end{equation}
%
In the above equation and throughout the work, the electron repulsion integral (ERI)
is defined according to
%
\begin{equation}
	\braket{\alpha\beta}{\gamma\delta} \equiv
	\iint 
	\frac{ \phi_\alpha^{*}({\bf r}_1) \phi_\beta({\bf r}_1) 
	       \phi_\gamma^{*}({\bf r}_2) \phi_\delta({\bf r}_2) }{ \vert {\bf r}_1 - {\bf r}_2 \vert}
	d{\bf r}_1 d{\bf r}_2  \;.
\end{equation}
%


\section{\label{s:2}Effective One-Electron Potentials: Configuration Interaction}

The time\hyp{}independent Schr{\"o}dinger equation provides the stationary solution to the
electronic state
of a molecular system in terms of its $N$\hyp{}electron wavefunction, $\Psi$,
%
\begin{equation} \label{e:schrodinger}
 E = \tBraKet{\Psi}{\mathscr{H}}{\Psi} \;,
\end{equation}
%
for a quantum Hamiltonian, $\mathscr{H} = \hat{h}(1) + \hat{o}(2)$,
with $\hat{h}(1)$ being the core Hamiltonian one\hyp{}electron operator
and $\hat{o}(2)$ the two\hyp{}electron repulsion operator.
From the above solution, any property $P$, understood as an expectation value of the
associated operator $\mathscr{P}$, can be computed according to
%
\begin{equation} \label{e:prop}
 P = \tBraKet{\Psi}{\mathscr{P}}{\Psi} \;.
\end{equation}
%
The exact solution to Eq.~\eqref{e:schrodinger} is formally given by
the configuration interaction (CI) expansion around the reference 
(approximate) wavefunction, $\Psi^{(0)}$,
typically the solution to the Hartree\hyp{}Fock (HF) problem,
%
\begin{equation} \label{e:ci}
 \Ket{\Psi} = \Ket{\Psi^{(0)}} + \sum_{ra} C_{r}^{a} \Ket{\Psi_{r}^{a}} + 
	 \sum_{rsab} C_{rs}^{ab} \Ket{\Psi_{rs}^{ab}} + \ldots
\end{equation}
%
In the above equation,
$\Ket{\Psi_{rs\ldots}^{ab\ldots}}$ are called the CI configurations
with the associated CI coefficients $C_{rs\ldots}^{ab\ldots}$, created by `exciting'
one or more electrons from the $a$th ($b$th) occupied molecular orbital to the $a$th ($b$th)
virtual (unoccupied) molecular orbital, obtained from the HF solution.
By inserting Eq.~\eqref{e:ci} into Eq.~\eqref{e:prop} 
and using the Slater\hyp{}Condon rules for evaluating the one\hyp{} and two\hyp{}electron
operator matrix element between
the CI configurations, it can be shown that the following holds
%
\begin{equation} \label{e:exp-val-series}
	P =
	\sum_{ij} P_{ij} \tBraKet{i}{\hat{h}}{j}
	+ \sum_{ijkl} P_{ijkl} \BraKet{ij}{kl}  \;,
\end{equation}
%
where $\tBraKet{i}{\hat{h}}{j} \equiv \int \phi^*_i({\bf r}) \hat{h} \phi_j({\bf r}) d{\bf r} $,
$\BraKet{ij}{kl}$ is the electron\hyp{}repulsion integral (ERI) defined by
%
\begin{equation}
	\BraKet{ij}{kl} \equiv
	\iint 
	\frac{ \phi_i^{*}({\bf r}_1) \phi_j({\bf r}_1) 
	       \phi_k^{*}({\bf r}_2) \phi_l({\bf r}_2) }{ \vert {\bf r}_1 - {\bf r}_2 \vert}
	d{\bf r}_1 d{\bf r}_2  \;,
\end{equation}
%
whereas the second\hyp{}rank tensor ${\bf P}^{(2)}$ 
and the fourth\hyp{}rank tensor ${\bf P}^{(4)}$ 
are well defined and characteristic for the property of interest.
%In this work we are interested in cases when

%$\Psi^{AB}$. In this Section we consider theories to calculate the effect of the interaction
%of molecules $A$ and $B$ on the property $P$ knowing only the unperturbed wavefunctions,
%$\Psi^{A}$ and $\Psi^{B}$.


\subsection{\label{ss:2.1}Intermolecular Interaction-Induced Property}

Consider a molecular aggregate consisting of two interacting 
molecules $A$ and $B$. The part of property that arises due to the
intermolecular interaction between $A$ and $B$ can be calculated
based on the supermolecular approach,
%
\begin{multline} \label{e:delta-p}
	\Delta^{AB} P = \tBraKet{\Psi^{AB}}{\mathscr{P}}{\Psi^{AB}} \\- 
	\left(
	    \tBraKet{\Psi^{A}}{\mathscr{P}}{\Psi^{A}} +
	    \tBraKet{\Psi^{B}}{\mathscr{P}}{\Psi^{B}}
	\right)
	\;,
\end{multline}
%
where $\Psi^{AB}$ and $\Psi^{A(B)}$ are the wavefunctions of the interacting molecular aggregate
and the unperturbed (non\hyp{}interacting) molecules, respectively.
The notation $\Delta^{AB}$ emphasizes on the two\hyp{}body character of the interaction\hyp{}induced
property. In this work we focus on re\hyp{}expressing $\Delta^{AB}P$ in terms of separate
fragments associated with either molecule. In general case when the basis set
is complete, such an operation is not possible. However,
assuming an approximation
in which the basis functions $\phi_i$ 
are localized on either molecule it allows one to partition the basis set space
and the resulting 2\hyp{} and 4\hyp{}index tensor elements
into subsets `belonging' either to molecule $A$ or to molecule $B$.
Such an approximation is essentially a foundation of any fragment\hyp{}based strategy
and, in particular, designing \emph{ab initio} force fields such as EFP2
of SolEFP.

Application of Eq.~\eqref{e:exp-val-series}
to Eq.~\eqref{e:delta-p} and adopting the localized basis set approximation
yields the partitioning of the interaction\hyp{}induced property,
%
\begin{equation}
 \Delta^{AB} P = \Delta^{AB} P(1) + \Delta^{AB} P(2) \;,
\end{equation}
%
for which the one\hyp{}electron part reads
%
\begin{multline} \label{e:delta-p-part-1el}
 \Delta^{AB} P(1) \approx
	\sum_{ij} \Big\{ 
	C^{AA}_{ij}  \BraKet{A}{A} +    %\tBraKet{i^A}{\hat{h}}{j^A} + 
	C^{BB}_{ij}  \BraKet{B}{B} \\ + %\tBraKet{i^B}{\hat{h}}{j^B} + 2 
2	C^{AB}_{ij}  \BraKet{A}{B}      %\tBraKet{i^A}{\hat{h}}{j^B} 
	\Big\}
\end{multline}
%
and the two\hyp{}electron part is given by
%
\begin{multline} \label{e:delta-p-part-2el}
 \Delta^{AB} P(2) \approx
	\sum_{ijkl} \Big\{ 
	C^{AAAA}_{ijkl} \BraKet{AA}{AA} \\ +    %\BraKet{i^Aj^A}{k^Al^A} +
	C^{BBBB}_{ijkl} \BraKet{BB}{BB} +  %\BraKet{i^Bj^B}{k^Bl^B} +
	{s} \left[ C^{AABB}_{ijkl} \BraKet{AA}{BB} \right] \\ + 
	{s} \left[ C^{ABAB}_{ijkl} \BraKet{AB}{AB} \right] + 
	{s} \left[ C^{AAAB}_{ijkl} \BraKet{AA}{AB} \right] \\ +
	{s} \left[ C^{ABBB}_{ijkl} \BraKet{AB}{BB} \right]
	\Big\} \;.
\end{multline}
%
To simplify the resulting expressions
in Eqs.~\eqref{e:delta-p-part-1el} and \eqref{e:delta-p-part-2el},
the shorthand notation $\BraKet{A}{B} \equiv \tBraKet{i^A}{\hat{h}}{j^B}$ and 
$\BraKet{AB}{CD} \equiv \BraKet{i^Aj^B}{k^Cl^D}$
was introduced, and
the real orbitals 
were assumed to simplify the symmetry of the one\hyp{} and two\hyp{}electron integrals.
The operator $s$ permutes and sums over all the combinations of the basis function indices
given their partitioning scheme between molecules $A$ and $B$.
All the summation components from Eqs.~\eqref{e:delta-p-part-1el} and \eqref{e:delta-p-part-2el} 
can be grouped into the three
sub\hyp{}categories: (i) Coulomb\hyp{}like terms
with integrals of the type $\BraKet{AA}{BB}$, (ii) overlap\hyp{}like terms with $\BraKet{AA}{AB}$
and $\BraKet{AB}{BB}$ and (iii) exchange\hyp{}like terms with $\BraKet{AB}{AB}$.

%Therefore, the interaction\hyp{}induced property can be recast in a following way

\subsection{\label{ss:2.3}Defining Effective Potentials}

Consider now an arbirtary functional $\mathcal{F}$ that explicitly depends on the 
ERI's. 
%
 \begin{equation}
 \mathcal{F}
 \left[ 
   \ERIc{i}{j}{k^B}{l^B}
	 \right] = \OEIc{i}{v_{kl}^B}{j}  \;,
 \end{equation}
%
where 
% $A$ and $B$ denote different molecules and $\phi_i$ is the $i$th molecular orbital
%or basis function.
$v_{kl}^B$ is the effective one-electron potential derived from the partial
effective densities $\rho_{kl}^B({\bf r}) = \phi_k^B({\bf r})\phi_l^B({\bf r})$.
The summations over $k$ and $l$ can be incorporated into the generalized one-electron potential
$v_{\text{eff}}^B$
to produce
%
\begin{equation}
	\sum_{ij}\sum_{kl\in B} \mathcal{F}\left[ 
   \ERIc{i}{j}{k^B}{l^B}
 \right] = \sum_{ij} \OEIc{i}{v_{\text{eff}}^B}{j}  \;.
\end{equation}
%
Thus, the total computational effort is, in principle, reduced from the fourth-fold
sum involving evaluation of ERI's to the two-fold sums of cheaper one-electron integrals.
It is also possible to generalize the above expression even further by
summing over all possible functionals ${\mathcal{F}}_t$
%
\begin{equation} \label{e:ft-reduction}
	\sum_t \sum_{ij}\sum_{kl\in B} {\mathcal{F}}_t\left[ 
   \ERIc{i}{j}{k^B}{l^B}
 \right] = \sum_{ij} \OEIc{i}{v_{\text{eff}}^B}{j} \;.
\end{equation}
%
The above design has the advantage that the effective potentials are fully first-principles
and no extensive case-dependent fitting procedures are necessary.
Only the effective potentials of \emph{independent} fragment $B$ need to be determined once and for all
and stored in a file. Note also, that, in principle, there is no approximation 
made here at that moment.

\subsection{\label{ss:2.4}Interaction-Induced Property: Effective Potentials}

The above technique can be now applied to the Coulomb\hyp{}like and overlap\hyp{}like 
terms from Eq.~\eqref{e:delta-p-part-2el}. For example, the Coulomb\hyp{}like contributions
can be rewritten without making any approximation as
%
\begin{equation}
 \sum_{ijkl} 
	{s} \left[ C^{AABB}_{ijkl} \BraKet{AA}{BB} \right]
 \equiv
	\sum_{kl\in B} 
	\tBraKet{k^B}{\hat{v}^{{\rm eff},A}}{l^B}
\end{equation}
%
with
%
\begin{equation}
 \hat{v}^{{\rm eff},A} 
	\equiv \sum_{ij\in A} {s} \left[ C^{AABB}_{ijkl} \hat{v}^{AA}_{ij} \right]  \;.
\end{equation}
%
Similarly for the overlap\hyp{}like term we have
%
\begin{equation}
 \sum_{ijkl} 
	{s} \left[ C^{AAAB}_{ijkl} \BraKet{AA}{AB} \right]
 \equiv
	\sum_{k\in A} \sum_{l\in B} 
	\tBraKet{k^A}{\hat{v}^{{\rm eff},A}}{l^B}
\end{equation}
%
and the associated effective potential reads
%
\begin{equation}
 \hat{v}^{{\rm eff},A} 
	\equiv \sum_{ij\in A} {s} \left[ C^{AAAB}_{ijkl} \hat{v}^{AA}_{ij} \right] \;.
\end{equation}
%
Note also that the exchange\hyp{}like terms cannot be represented in terms of OEP's.
Gathering the above arguments, $\Delta^{AB}P$ adopts the following form
%
\begin{multline}
 \Delta^{AB}P \approx \Delta_{\rm ex}^{AB} P
	+ \sum_{i\in A} \sum_{j\in B} 
	\left\{
	  \tBraKet{i}{\hat{v}^{{\rm eff},A}_1 }{j}
	+ \tBraKet{i}{\hat{v}^{{\rm eff},B}_1 }{j}
	\right\} \\ +
	\frac{1}{2}
	\sum_{i\in A} \sum_{k\in A}
	  \tBraKet{i}{\hat{v}^{{\rm eff},B}_2 }{k}
	 +
	 \frac{1}{2}
        \sum_{l\in B} \sum_{l\in B}
          \tBraKet{l}{\hat{v}^{{\rm eff},A}_2 }{l}
\end{multline}
%
where the exchange\hyp{}like component is
%
\begin{equation}
	\Delta_{\rm ex}^{AB} P = 
	\sum_{ik\in A} \sum_{jl\in B}
	{s} \left[ C^{ABAB}_{ijkl} \BraKet{AB}{AB} \right] \;.
\end{equation}
%
whereas
the overlap\hyp{}like and the Coulomb\hyp{}like 
OEP's are defined as follows
%
\begin{align}
	\hat{v}^{{\rm eff},A}_1 &\equiv C_{ij}^{AB} 
	+ \sum_{kk'\in A} {s} \left[ C^{AAAB}_{kk'ij} \hat{v}_{kk'}^{AA} \right] \\
	%
	\hat{v}^{{\rm eff},A}_2 &\equiv 
	+ \sum_{kk'\in A} {s} \left[ C^{AAAB}_{kk'ij} \hat{v}_{kk'}^{AA} \right] \\
\end{align}
%
and accordingly for the twin terms (molecule $B$).

\section{\label{s.334}Practical Calculations with OEP's}

There are two general cases of basis function partitioning scheme
in which it is possible to define an effective one\hyp{}electron
potential.
The first type is a Coulomb\hyp{}like contribution, for which multipole expansion or density fitting can be used.
The second type is an overlap\hyp{}like contribution, can be approximated with the density fitting. Mainly,
%
\begin{subequations}
 \begin{align}
 \mathcal{F}
 \left[ 
   \ERIc{i^A}{j^A}{k^B}{l^B}
	 \right] = \OEIc{i^A}{v_{kl}^B}{j^A} \\ \nonumber \rightarrow \text{ multipole expansion or density fitting}\\ 
%
 \mathcal{F}
 \left[ 
   \ERIc{i^A}{j^B}{k^B}{l^B}
	 \right] = \OEIc{i^A}{v_{kl}^B}{j^B} \\ \rightarrow \text{ density fitting} \nonumber
 \end{align}
\end{subequations}
%

\subsection{\label{s.333}Distributed Multipole Expansion of OEP's}

\subsection{\label{s.334}Density Fitting of OEP's}

To get the \emph{ab initio} representation of a overlap\hyp{}like OEP, 
one can use a procedure similar to
the typical density fitting or resolution of identity, both of which are nowadays widely used 
to compute electron-repulsion integrals (ERI's) more efficiently. 

\subsubsection{Density Fitting in Nearly-Complete Space}

An arbitrary one-electron potential of molecule $A$ acting on any state vector 
associated with molecule $A$ can be expanded in an *auxiliary space* centered 
on $A$ as
\begin{equation}
   v\vert i) = \sum_{\xi\eta} v\vert \xi) [{\bf S}^{-1}]_{\xi\eta} ( \eta \vert i)
\end{equation}
under the necessary assumption that the auxiliary basis set is nearly complete.
In a special case when the basis set is orthogonal (e.g., molecular orbitals)
the above relation simplifies to
\begin{equation}
   v\vert i) = \sum_{\xi} v\vert \xi) ( \xi \vert i)
\end{equation}
It can be easily shown that the above general and exact expansion can be obtained by 
performing a density fitting in the complete space. We expand the LHS of the first equation 
on this page in a series of the auxiliary basis functions scaled by the undetermined expansion coefficients:
\begin{equation}
  v\vert i) = \sum_{\xi} {G_{i\xi}} \vert \xi)
\end{equation}
which we shall refer here as to the matrix form of the OEP operator.
By constructing the least-squares objective function 
\begin{equation}
 Z[\{G^{(i)}_\xi\}] = \int d{\bf r}_1
                     \left[    v({\bf r}_1) \phi_i({\bf r}_1) - \sum_\xi G^{(i)}_\xi \varphi_\xi({\bf r}_1) \right]^2
\end{equation}
and requiring that
\begin{equation}
 \frac{\partial Z[\{G^{(i)}_\xi\}]}{\partial G^{(i)}_\mu} = 0 \text{ for all $\mu$}
\end{equation}
we find the coefficients $ G^{(i)}_\xi $ to be
\begin{equation}
 {\bf G}^{(i)} = {\bf v}^{(i)} \cdot {\bf S}^{-1}
\end{equation}
where
\begin{align}
 v^{(i)}_\eta &= (\eta \vert vi) \\
 S_{\eta\xi}  &= (\eta \vert \xi)
\end{align}
or explitictly
\begin{equation}
  {G_{i\xi}} = \sum_\eta [{\bf S}^{-1}]_{\xi\eta} (\eta\vert v\vert i)
\end{equation}
identical to what we obtained from application of the resolution of identity 
in space spanned by non-orthogonal complete set of basis vectors.

Since matrix elements of an OEP operator in auxiliary space can be computed 
in the same way as the matrix elements with any other basis function, 
one can formally write the following identity
\begin{equation}
 (X \vert v\vert i) = \sum_{\xi\eta} S_{X \xi} [{\bf S}^{-1}]_{\xi\eta} (\eta\vert v\vert i)
\end{equation}
where $ X $ is an arbitrary orbital.
When the other orbital
does not belong to molecule $A$ but to the (changing) environment, it is 
straightforward to compute the resulting matrix element, which is simply given as  
\begin{equation}
   (j_{\in B} \vert v^A \vert i_{\in A}) = \sum_\xi {S_{j\xi}} {G_{i\xi}}
\end{equation}
where $j$ denotes the other (environmental) basis function.

\subsubsection{Density Fitting in Incomplete Space}

Density fitting scheme from previous section has practical disadvantage of a nearly-complete basis set
being usually very large (spanned by large amount of basis set vectors). Any non-complete basis set
won't work in the previous example. Since most of basis sets used in quantum chemistry do not form a nealy complete
set, it is beneficial to design a modified scheme in which it is possible to obtain the effective 
matrix elements of the OEP operator in a incomplete auxiliary space. This can be achieved by minimizing 
the following objective function
\begin{multline}
	Z[\{G^{(i)}_\xi\}] = \iint d{\bf r}_1 d{\bf r}_2 \Bigg\{
                     \left[    v({\bf r}_1) \phi_i({\bf r}_1) - \sum_\xi G^{(i)}_\xi \varphi_\xi({\bf r}_1) \right]
                  \\ \times \frac{1}{\vert {\bf r}_1 - {\bf r}_2 \vert}  
                     \left[    v({\bf r}_2) \phi_i({\bf r}_2) - \sum_\xi G^{(i)}_\eta\varphi_\eta({\bf r}_1) \right]
		    \Bigg\}
\end{multline}
Thus requesting that 
\begin{equation}
 \frac{\partial Z[\{G^{(i)}_\xi\}]}{\partial G^{(i)}_\mu} = 0 \text{ for all $\mu$}
\end{equation}
we find the coefficients $ G^{(i)}_\xi $ to be
\begin{equation}
 {\bf G}^{(i)} = {\bf b}^{(i)} \cdot {\bf A}^{-1}
\end{equation}
where 
\begin{align}
 b^{(i)}_\eta &= (\eta \vert\vert vi) \\
 A_{\eta\xi}  &= (\eta \vert\vert \xi)
\end{align}
The symbol $ \vert\vert $ is to denote the operator $ r_{12}^{-1}$ and double integration over $ {\bf r}_1 $
and $ {\bf r}_2 $. Thus, it is clear that in order to use this generalized density fitting scheme
one must to compute two\hyp{}centre electron repulsion integrals
as well as four\hyp{}centre asymmetric electron repulsion integrals of the type $ (\alpha\beta\gamma||\eta) $.
The evaluation of such integrals is discussed in Appendix~\ref{a:mcmurchie-davidson}.



\section{\label{s:3}Calculation Details}
\section{\label{s:4}Results and Discussion}
\subsection{\label{ss.4.1}Pauli-Repulsion Interaction Energy}
\subsection{\label{ss.4.2}Charge-Transfer Interaction Energy}
\section{\label{s:5}Summary and a few concluding remarks}


\begin{acknowledgments}
This project is carried out under POLONEZ programme which has received funding from the European Union's
Horizon~2020 research and innovation programme under the Marie Sk≈Çodowska-Curie grant agreement 
No.~665778. This project is funded by National Science Centre, Poland 
(grant~no. 2016/23/P/ST4/01720) within the POLONEZ 3 fellowship.
\end{acknowledgments}

%
\appendix

\section{\label{a:mcmurchie-davidson} McMurchie-Davidson Method for Asymmetric Electron Repulsion Integrals}

Evaluation of integrals $(ijk\vert l)$,
that are necessary for the generalized density fitting of OEP's,
can be easily carried out by re\hyp{}expressing the
unnormalized product of three primitive Gaussian\hyp{}type (GTO) functions,
%
\begin{equation} \label{e:1}
[ijk] \equiv \phi_i({\bf r}) \phi_j({\bf r}) \phi_k({\bf r}) \;,
\end{equation}
%
in terms of Hermite functions. It can be shown that
%
\begin{multline} \label{e:2}
   [ijk] = E_{ijk} \sum_{N=0}^{n_1+n_2+n_3} \sum_{L=0}^{l_1+l_2+l+3} \sum_{M=0}^{m_1+m_2+m_3} 
	\\
          d_N^{n_1n_2n_3} d_L^{l_1l_2l_3} d_M^{m_1m_2m_3}
          \Lambda_N(x_R)\Lambda_L(y_R)\Lambda_M(z_R)e^{-\alpha_Rr_R^2}
\end{multline}
%
in which the McMurchie-Davidson $d3$ coefficients are given by the following recurrence relationships
%
 \begin{align} \label{e:3}
  d_N^{n_1+1,n_2,n_3} &= \frac{1}{2\alpha_R} d_{N-1}^{n_1n_2n_3} 
                             + \vert {\bf R} - {\bf A}\vert_x d_N^{n_1n_2n_3} \nonumber \\ 
			    & \qquad\qquad + (N+1) d_{N+1}^{n_1n_2n_3} \\
  d_N^{n_1,n_2+1,n_3} &= \frac{1}{2\alpha_R} d_{N-1}^{n_1n_2n_3} 
                             + \vert {\bf R} - {\bf B}\vert_x d_N^{n_1n_2n_3} \nonumber \\
			    & \qquad\qquad + (N+1) d_{N+1}^{n_1n_2n_3} \\
  d_N^{n_1,n_2,n_3+1} &= \frac{1}{2\alpha_R} d_{N-1}^{n_1n_2n_3} 
                             + \vert {\bf R} - {\bf C}\vert_x d_N^{n_1n_2n_3} \nonumber \\
			    & \qquad\qquad + (N+1) d_{N+1}^{n_1n_2n_3} 
\end{align}
%
with $d_0^{000} = 1$.
In Eq.~\eqref{e:1},
$\phi_i({\bf r})$ is given by
%
\begin{equation}
\phi_i({\bf r}) \equiv x_A^{n_1} y_A^{l_1} z_A^{m_1} e^{-\alpha_1r_A^2}
\end{equation}
%
where 
${\bf r}_A \equiv {\bf r} - {\bf A}$,
${\bf A}$ is the centre of the GTO, $\alpha_1$ its exponent, whereas $n_1,l_1,m_1$
the Cartesian angular momenta, with the total angular momentum $\theta_1 = n_1+l_1+m_1$.

It can be easily shown that the multiplicative constant $E_{ijk}$ is given by
%
\begin{multline}
  E_{ijk}(\alpha_1,\alpha_2,\alpha_3)  = \exp{\left[-\frac{\alpha_1\alpha_2}
                                        {\alpha_1+\alpha_2}\vert {\bf A}-{\bf B}\vert^2\right]} \\ \times
                                         \exp{\left[-\frac{(\alpha_1+\alpha_2)\alpha_3}
                                        {\alpha_1+\alpha_2+\alpha_3}
                                         \vert {\bf P}-{\bf C}\vert^2\right]} 
\end{multline}
%

% -----------------------
\bibliography{references}
% -----------------------

\end{document}
